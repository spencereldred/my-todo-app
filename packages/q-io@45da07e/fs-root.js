function RootFs(e,t){function n(n){var i;return i=e.isAbsolute(n)?e.relativeFromDirectory(e.ROOT,n):n,i=e.join(e.ROOT,i),i=e.relativeFromDirectory(e.ROOT,i),i=e.join(t,i),e.canonical(i).then(function(e){return e},function(){return i}).then(function(i){return e.contains(t,i)?{inner:e.join(e.ROOT,e.relativeFromDirectory(t,i)),outer:i}:Q.reject("Can't find: "+JSON.stringify(n))})}function i(){return e.ROOT}var r=Object.create(BOOT);return COMMON.update(r,i),r.list=function(t){return n(t).then(function(t){return e.list(t.outer)}).then(null,function(){return Q.reject("Can't list "+JSON.stringify(t))})},r.open=function(t,i,r){return n(t).then(function(t){return e.open(t.outer,i,r)}).then(null,function(){return Q.reject("Can't open "+JSON.stringify(t))})},r.stat=function(t){return n(t).then(function(t){return e.stat(t.outer)}).then(null,function(){return Q.reject("Can't stat "+JSON.stringify(t))})},r.statLink=function(t){return n(t).then(function(t){return e.statLink(t.outer)}).then(null,function(){return Q.reject("Can't statLink "+JSON.stringify(t))})},r.canonical=function(e){return n(e).then(function(e){return e.inner}).then(null,function(){return Q.reject("Can't find canonical of "+JSON.stringify(e))})},r.makeDirectory=function(t){return n(t).then(function(t){return e.makeDirectory(t.outer)}).catch(function(){throw Error("Can't make directory "+JSON.stringify(t))})},r.removeDirectory=function(t){return n(t).then(function(t){return e.removeDirectory(t.outer)}).catch(function(){throw Error("Can't remove directory "+JSON.stringify(t))})},r.remove=function(t){return n(t).then(function(t){return e.remove(t.outer)}).catch(function(){throw Error("Can't remove "+JSON.stringify(t))})},r.makeTree=function(t){return n(t).then(function(t){return e.makeTree(t.outer)}).catch(function(){throw Error("Can't make tree "+JSON.stringify(t))})},r.removeTree=function(t){return n(t).then(function(t){return e.removeTree(t.outer)}).catch(function(){throw Error("Can't remove tree "+JSON.stringify(t))})},Q.when(e.canonical(t),function(e){return t=e,r})}var Q=require("q"),BOOT=require("./fs-boot"),COMMON=require("./fs-common");module.exports=RootFs;